{"version":3,"sources":["square.js"],"names":["SquareFrame","require","scaleParam","cc","Class","extends","Component","properties","checkerboard","default","type","sideLength","SpriteFrame","getTheConfig","a","configLists","v2","newOneK","colorIndex","node","Node","sprite","addComponent","Sprite","spriteFrame","sizeMode","SizeMode","CUSTOM","width","height","newOneNode","squareNode","config","randomIndex","Math","floor","random","length","posList","sumX","countX","sumY","countY","index","pos","square","x","y","addChild","setScale","addTouchEvent","upH","self","ox","oy","on","EventType","TOUCH_START","getChildByName","find","emit","TOUCH_MOVE","event","delta","touch","getDelta","collisionFunc","checkIsCanDrop","changeColorDeal","TOUCH_CANCEL","dropDownFunc","TOUCH_END","isJustClearColor","i","frameList","PicNode","getComponent","framePic","opacity","checkFrameList","FKsprite","checkFKlist","children","pianyiCPos","add","childPos","position","frame","checkPosFunc","push","len","frameNode","dis","sub","mag","checkIsLose","canDropCount","srcPos","count","isHaveFK","j","k","tFrameNode","takeBack","parent","removeAllChildren","oneNode","curFKLen","onLoad","checkSquareList"],"mappings":"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","file":"square.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nconst SquareFrame = require('squareframe');\r\nconst scaleParam = 0.5;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        checkerboard: {\r\n            default: null,\r\n            type: SquareFrame\r\n        },\r\n        sideLength: 0,\r\n        [\"color1\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color2\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color3\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color4\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color5\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color6\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        [\"color7\"]: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n    },\r\n\r\n    getTheConfig: function() {\r\n\r\n        var a = this.sideLength;\r\n\r\n        var configLists = [\r\n            //一个\r\n            [cc.v2(0, 0)],\r\n            //两个\r\n            [cc.v2(0, 0), cc.v2(a, 0)], //横摆\r\n            [cc.v2(0, 0), cc.v2(0, a)], //竖摆\r\n            //三个\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a * 2, 0)], //横摆\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(0, a * 2)], //竖摆\r\n\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a, a)], //堆1\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(0, a)], //堆2\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(a, a)], //堆3\r\n            [cc.v2(0, a), cc.v2(a, 0), cc.v2(a, a)], //堆4\r\n            //四个\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a * 2, 0), cc.v2(a * 3, 0)], //横摆\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(0 , a * 2), cc.v2(0, a * 3)], //竖摆\r\n\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a * 2, 0), cc.v2(a * 2, a)], //横堆1\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a * 2, 0), cc.v2(0, a)], //横堆2\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a * 2, 0), cc.v2(a * 2, -a)], //横堆3\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a * 2, 0), cc.v2(0, -a)], //横堆4\r\n\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(0, a * 2), cc.v2(a, a * 2)], //竖堆1\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(0, a * 2), cc.v2(a, 0)], //竖堆2\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(0, a * 2), cc.v2(-a, a * 2)], //竖堆3\r\n            [cc.v2(0, 0), cc.v2(0, a), cc.v2(0, a * 2), cc.v2(-a, 0)], //竖堆4\r\n\r\n            [cc.v2(0, 0), cc.v2(a, 0), cc.v2(a, a), cc.v2(0, a)], //方堆\r\n        ];\r\n\r\n        return configLists;\r\n    },\r\n\r\n    newOneK: function(colorIndex) {\r\n        //创建一个块\r\n        var node = new cc.Node(\"colorSpr\");\r\n        var sprite = node.addComponent(cc.Sprite);\r\n        sprite.spriteFrame = this[\"color\" + colorIndex];\r\n        sprite.sizeMode = cc.Sprite.SizeMode.CUSTOM;\r\n        \r\n        node.width = this.sideLength;\r\n        node.height= this.sideLength;\r\n\r\n        return node;\r\n    },\r\n\r\n    newOneNode: function() {\r\n        var squareNode = new cc.Node(\"square\");\r\n\r\n        var config = this.getTheConfig();\r\n        //随机样子\r\n        var randomIndex = Math.floor(Math.random()*config.length);\r\n        var posList = config[randomIndex];\r\n\r\n        var randomIndex = Math.floor(Math.random()*6 + 1);\r\n        var sumX = 0;\r\n        var countX = 0;\r\n        var sumY = 0;\r\n        var countY = 0;\r\n        for (var index = 0; index < posList.length; index++) {\r\n            var pos = posList[index];\r\n            var square = this.newOneK(randomIndex);\r\n            square.x = pos.x;\r\n            \r\n            sumX += square.x;\r\n            countX++;\r\n\r\n            square.y = pos.y;\r\n\r\n            sumY += square.y;\r\n            countY++;\r\n\r\n            squareNode.addChild(square);\r\n        }\r\n\r\n        squareNode.x = -sumX / countX * scaleParam;\r\n        squareNode.y = -sumY / countY * scaleParam;\r\n\r\n        squareNode.setScale(scaleParam);\r\n\r\n        return squareNode;\r\n    },\r\n\r\n    addTouchEvent: function() {\r\n        var upH = 100;\r\n        var self = this;\r\n\r\n        this.node.ox = this.node.x;\r\n        this.node.oy = this.node.y;\r\n\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, function() {\r\n            this.y += upH;\r\n\r\n            this.getChildByName(\"square\").setScale(1);\r\n\r\n            \r\n            cc.find('Canvas/pause').emit('touchOne');\r\n        }, this.node);\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, function(event) {\r\n\r\n            var delta = event.touch.getDelta();\r\n            this.x += delta.x;\r\n            this.y += delta.y;\r\n\r\n            self.collisionFunc();\r\n\r\n            // 变色处理\r\n            if (!self.checkIsCanDrop()) {\r\n                self.changeColorDeal(true);\r\n            } else {\r\n                self.changeColorDeal();\r\n            }\r\n        }, this.node);\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, function(event) {\r\n            this.dropDownFunc();\r\n\r\n        }, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, function(event) {\r\n            this.dropDownFunc();\r\n\r\n        }, this);\r\n\r\n    },\r\n\r\n    //变色处理\r\n    changeColorDeal: function(isJustClearColor) {\r\n        for (var i = 0; i < this.checkerboard.frameList.length; i++) {\r\n            var PicNode = this.checkerboard.frameList[i];\r\n            var sprite = PicNode.getComponent(cc.Sprite);\r\n            sprite.spriteFrame = this.checkerboard.framePic;\r\n            PicNode.opacity = 255;\r\n        }\r\n\r\n        //直接返回\r\n        if (isJustClearColor) {\r\n            return\r\n        }\r\n\r\n        for (var i = 0; i < this.checkFrameList.length; i++) {\r\n            var PicNode = this.checkFrameList[i];\r\n            var sprite = PicNode.getComponent(cc.Sprite);\r\n            var FKsprite = this.checkFKlist[0].getComponent(cc.Sprite);\r\n            sprite.spriteFrame = FKsprite.spriteFrame;\r\n            PicNode.opacity = 127;\r\n        }\r\n\r\n    },\r\n\r\n\r\n    //碰撞逻辑\r\n    collisionFunc: function() {\r\n        this.checkFrameList = [];//清空数组\r\n        this.checkFKlist = []; //清空数组\r\n\r\n        var children = this.node.children[0].children;\r\n\r\n        for (var i = 0; i < children.length; i++) {\r\n\r\n            var pianyiCPos = cc.v2(this.node.children[0].x, this.node.children[0].y).add(cc.v2(children[i].x, children[i].y));\r\n            var childPos = this.node.position.add(pianyiCPos);\r\n            var frame = this.checkPosFunc(childPos);\r\n\r\n            if (frame) {\r\n                this.checkFKlist.push(children[i]);\r\n                this.checkFrameList.push(frame);\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n\r\n    //一个色块和所有框检测\r\n    checkPosFunc: function(pos) {\r\n        var len = this.sideLength / 2; //碰撞距离\r\n\r\n        for (var i = 0; i < this.checkerboard.frameList.length; i++) {\r\n            var frameNode = this.checkerboard.frameList[i];\r\n            var dis = cc.v2(frameNode.x, frameNode.y).sub(pos).mag();\r\n            if (dis <= len) {\r\n                return frameNode;\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    //检测自身是否已经无处可放\r\n    checkIsLose: function() {\r\n        var canDropCount = 0;\r\n\r\n\r\n        var children = this.node.children[0].children;\r\n\r\n        //一个个格子放试一下能不能放\r\n        for (var i = 0; i < this.checkerboard.frameList.length; i++) {\r\n            var frameNode = this.checkerboard.frameList[i];\r\n            var srcPos = cc.v2(frameNode.x, frameNode.y);\r\n\r\n\r\n\r\n            var count = 1;\r\n            if (!frameNode.isHaveFK) {\r\n\r\n                for (var j = 1; j < children.length; j++) {\r\n                    var len = this.sideLength / 2; //碰撞距离\r\n                    var childPos = srcPos.add(cc.v2(children[j].x, children[j].y));\r\n\r\n                    //碰撞检测\r\n                    for (var k = 0; k < this.checkerboard.frameList.length; k++) {\r\n                        var tFrameNode = this.checkerboard.frameList[k];\r\n                        var dis = cc.v2(tFrameNode.x, tFrameNode.y).sub(childPos).mag();\r\n                        if (dis <= len && !tFrameNode.isHaveFK) {\r\n                            count++; \r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n                if (count == children.length) {\r\n                    canDropCount++;\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        if (canDropCount == 0) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    //检测是否能够放下\r\n    checkIsCanDrop: function() {\r\n        if (this.checkFrameList.length == 0 || this.checkFrameList.length != this.node.children[0].children.length) {\r\n            return false;\r\n        }\r\n\r\n        for (var i = 0; i < this.checkFrameList.length; i++) {\r\n            if (this.checkFrameList[i].isHaveFK) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    //放下\r\n    dropDownFunc: function() {\r\n\r\n        if (!this.checkIsCanDrop()) {\r\n            //放回去\r\n            this.takeBack();\r\n            return;\r\n        }\r\n\r\n        for (var i = 0; i < this.checkFKlist.length; i++) {\r\n            this.checkFKlist[i].x = 0;\r\n            this.checkFKlist[i].y = 0;\r\n\r\n\r\n            this.checkFKlist[i].parent = this.checkFrameList[i];\r\n            this.checkFrameList[i].isHaveFK = true;\r\n\r\n        }\r\n\r\n        this.node.removeAllChildren();\r\n        var oneNode = this.newOneNode();\r\n        this.node.addChild(oneNode);\r\n\r\n        this.checkerboard.curFKLen = this.checkFKlist.length;\r\n        this.checkerboard.node.emit('succDropDownOne');\r\n\r\n        // var ranC = Util.random(1, 3)\r\n        // cc.audioEngine.playEffect(this[\"fangxiaSound\" + ranC])\r\n\r\n\r\n        //放回去\r\n        this.takeBack();\r\n        //直接用棋盘检测是不是输了\r\n        this.checkerboard.checkIsLose()\r\n    },\r\n\r\n    //回到原位\r\n    takeBack: function() {\r\n        //变色处理\r\n        this.checkFrameList = []; //清空数组\r\n        this.changeColorDeal()\r\n\r\n        this.node.getChildByName(\"square\").setScale(scaleParam);\r\n\r\n        this.node.x = this.node.ox;\r\n        this.node.y = this.node.oy;\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad:function() {\r\n        this.checkFrameList = [];\r\n        this.checkSquareList = [];\r\n\r\n        var oneNode = this.newOneNode();\r\n        this.node.addChild(oneNode);\r\n\r\n        // 添加触摸\r\n        this.addTouchEvent();\r\n    },\r\n\r\n    // start () {\r\n\r\n    // },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}